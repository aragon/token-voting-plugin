GovernanceERC20Test:
  - given: The contract is deployed with default mint settings
    and:
      - when: Calling initialize() again
        then:
          - it: reverts if trying to re-initialize
      - when: Checking the token name and symbol
        then:
          - it: sets the token name and symbol
      - when: Checking the managing DAO
        then:
          - it: sets the managing DAO
      - when: Deploying with mismatched receivers and amounts arrays
        then:
          - it: reverts if the `receivers` and `amounts` array lengths in the mint settings mismatch

  - given: The contract is deployed
    comment: "ERC-165"
    and:
      - when: Calling supportsInterface with the empty interface
        then:
          - it: does not support the empty interface
      - when: Calling supportsInterface with the IERC165Upgradeable interface
        then:
          - it: supports the `IERC165Upgradeable` interface
      - when: Calling supportsInterface with all inherited interfaces
        then:
          - it: it supports all inherited interfaces

  - given: The contract is deployed
    comment: "mint"
    and:
      - given: The caller is missing the MINT_PERMISSION_ID
        and:
          - when: Calling mint()
            then:
              - it: reverts if the `MINT_PERMISSION_ID` permission is missing
      - given: The caller has the MINT_PERMISSION_ID
        and:
          - when: Calling mint()
            then:
              - it: mints tokens if the caller has the `mintPermission`

  - given: The contract is deployed with initial balances
    comment: "delegate"
    and:
      - when: Delegating voting power to another account
        then:
          - it: delegates voting power to another account
      - when: Delegating voting power multiple times
        then:
          - it: is checkpointed

  - given: A token is deployed and the main signer can mint
    comment: "afterTokenTransfer"
    and:
      - when: Minting tokens to an address for the first time
        then:
          - it: turns on delegation after mint
      - when: Transferring tokens to an address for the first time
        then:
          - it: turns on delegation for the `to` address after transfer
      - when: Performing a chain of transfers A => B => C
        then:
          - it: turns on delegation for all users in the chain of transfer A => B => C
      - given: The receiver has manually turned off delegation
        and:
          - when: Transferring tokens to the receiver
            then:
              - it: should not turn on delegation on `transfer` if `to` manually turned it off
          - when: Minting tokens to the receiver
            then:
              - it: should not turn on delegation on `mint` if `to` manually turned it off
      - given: A user has pre-delegated before receiving tokens
        and:
          - when: Transferring tokens to the user
            then:
              - it: should not rewrite delegation setting for `transfer` if user set it on before receiving tokens
          - when: Minting tokens to the user
            then:
              - it: should not rewrite delegation setting for `mint` if user set it on before receiving tokens
      - given: Delegation was turned on in the past
        and:
          - when: Minting more tokens
            then:
              - it: should not turn on delegation on `mint` if it was turned on at least once in the past
          - when: Transferring more tokens
            then:
              - it: should not turn on delegation on `transfer` if it was turned on at least once in the past
      - when: Transferring tokens from an address with delegation turned on
        then:
          - it: updates voting power after transfer for `from` if delegation turned on
      - when: Transferring tokens to an address with delegation turned on
        then:
          - it: updates voting power after transfer for `to` if delegation turned on

  - given: A token is deployed and the main signer can mint
    comment: "afterTokenTransfer - exhaustive tests"
    and:
      - given: The `to` address has a zero balance
        and:
          - given: The `to` address has delegated to `other`
            and:
              - when: The `to` address receives tokens via mint
                then:
                  - it: "`to` has the correct voting power"
                  - it: "`to`s delegate has not changed"
                  - it: "`to`s delegate has the correct voting power"
              - when: The `to` address receives tokens via transfer from `from`
                then:
                  - it: "`from` has the correct voting power"
                  - it: "`from`s delegate has not changed"
                  - it: "`from`s delegate has the correct voting power"
                  - it: "`to` has the correct voting power"
                  - it: "`to`s delegate has not changed"
                  - it: "`to`s delegate has the correct voting power"
          - given: The `to` address has not delegated before
            and:
              - when: The `to` address receives tokens via mint
                then:
                  - it: "`to` has the correct voting power"
                  - it: "`to`s delegate has not changed"
                  - it: "`to`s delegate has the correct voting power"
              - when: The `to` address receives tokens via transfer from `from`
                then:
                  - it: "`from` has the correct voting power"
                  - it: "`from`s delegate has not changed"
                  - it: "`from`s delegate has the correct voting power"
                  - it: "`to` has the correct voting power"
                  - it: "`to`s delegate has not changed"
                  - it: "`to`s delegate has the correct voting power"
      - given: The `to` address has a non-zero balance
        and:
          - given: The `to` address has delegated to `other`
            and:
              - when: The `to` address receives tokens via mint
                then:
                  - it: "`to` has the correct voting power"
                  - it: "`to`s delegate has not changed"
                  - it: "`to`s delegate has the correct voting power"
                and:
                  - when: The `to` address then transfers to `other`
                    then:
                      - it: "`to` has the correct voting power"
                      - it: "`to`s delegate has not changed"
                      - it: "`to`s delegate has the correct voting power"
                  - when: The `to` address then delegates to `other` again
                    then:
                      - it: "`to` has the correct voting power"
                      - it: "`to`s delegate is correctly changed"
                      - it: "`to`s delegate has the correct voting power"
              - when: The `to` address receives tokens via transfer from `from`
                then:
                  - it: "`from` has the correct voting power"
                  - it: "`from`s delegate has not changed"
                  - it: "`from`s delegate has the correct voting power"
                  - it: "`to` has the correct voting power"
                  - it: "`to`s delegate has not changed"
                  - it: "`to`s delegate has the correct voting power"
                and:
                  - when: The `to` address then transfers to `other`
                    then:
                      - it: "`to` has the correct voting power"
                      - it: "`to`s delegate has not changed"
                      - it: "`to`s delegate has the correct voting power"
                  - when: The `to` address then delegates to `other` again
                    then:
                      - it: "`to` has the correct voting power"
                      - it: "`to`s delegate is correctly changed"
                      - it: "`to`s delegate has the correct voting power"
          - given: The `to` address has not delegated before
            and:
              - when: The `to` address receives tokens via mint
                then:
                  - it: "`to` has the correct voting power"
                  - it: "`to`s delegate has not changed"
                  - it: "`to`s delegate has the correct voting power"
                and:
                  - when: The `to` address then transfers to `other`
                    then:
                      - it: "`to` has the correct voting power"
                      - it: "`to`s delegate has not changed"
                      - it: "`to`s delegate has the correct voting power"
                  - when: The `to` address then delegates to `other`
                    then:
                      - it: "`to` has the correct voting power"
                      - it: "`to`s delegate is correctly changed"
                      - it: "`to`s delegate has the correct voting power"
              - when: The `to` address receives tokens via transfer from `from`
                then:
                  - it: "`from` has the correct voting power"
                  - it: "`from`s delegate has not changed"
                  - it: "`from`s delegate has the correct voting power"
                  - it: "`to` has the correct voting power"
                  - it: "`to`s delegate has not changed"
                  - it: "`to`s delegate has the correct voting power"
                and:
                  - when: The `to` address then transfers to `other`
                    then:
                      - it: "`to` has the correct voting power"
                      - it: "`to`s delegate has not changed"
                      - it: "`to`s delegate has the correct voting power"
                  - when: The `to` address then delegates to `other`
                    then:
                      - it: "`to` has the correct voting power"
                      - it: "`to`s delegate is correctly changed"
                      - it: "`to`s delegate has the correct voting power"

  - given: Minting is allowed
    and:
      - given: Calling mint() with the permission
        then:
          - it: Should mint properly
      - given: Calling mint() without the permission
        then:
          - it: Should revert
      - given: Calling freezeMinting() with the permission
        then:
          - it: Should disallow mints from then on
      - given: Calling freezeMinting() without the permission
        then:
          - it: Should revert
  - given: Minting is frozen
    and:
      - given: Calling mint() with the permission
        then:
          - it: Should revert
      - given: Calling mint() without the permission
        then:
          - it: Should revert
      - given: Calling freezeMinting() with the permission
        then:
          - it: Should do nothing
      - given: Calling freezeMinting() without the permission
        then:
          - it: Should revert
